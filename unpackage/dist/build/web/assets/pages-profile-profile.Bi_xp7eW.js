import{q as t,$ as e,a as s,u as a,v as l,n as o,k as n,x as i,s as c,y as d,c as r,w as u,i as g,o as f,d as _,e as h,t as m,g as k,l as p,r as L,F as b,p as y,z as W,m as v,f as C}from"./index-B7OQiFPg.js";import{c as w,a as S,b as U,g as D}from"./bookData.ioIksG53.js";import{_ as B}from"./_plugin-vue_export-helper.BCo6x5W8.js";const I=B({data:()=>({bookList:w,currentUser:null,userStats:null,totalLearnedWords:0,totalWrongWords:0,completedBooks:0,achievements:[{id:1,title:"åˆå­¦è€…",description:"å­¦ä¹ ç¬¬ä¸€ä¸ªå•è¯",icon:"ğŸŒ±",unlocked:!1,condition:t=>t.totalLearnedWords>=1},{id:2,title:"å‹¤å­¦è€…",description:"å­¦ä¹ 50ä¸ªå•è¯",icon:"ğŸ“š",unlocked:!1,condition:t=>t.totalLearnedWords>=50},{id:3,title:"è¿›æ­¥è€…",description:"å­¦ä¹ 100ä¸ªå•è¯",icon:"ğŸš€",unlocked:!1,condition:t=>t.totalLearnedWords>=100},{id:4,title:"ä¸“å®¶çº§",description:"å­¦ä¹ 200ä¸ªå•è¯",icon:"ğŸ‘‘",unlocked:!1,condition:t=>t.totalLearnedWords>=200},{id:5,title:"å®Œç¾ä¸»ä¹‰è€…",description:"å®Œæˆä¸€æœ¬ä¹¦çš„å­¦ä¹ ",icon:"ğŸ’¯",unlocked:!1,condition:t=>t.completedBooks>=1},{id:6,title:"åšæŒè€…",description:"æ³¨å†Œ7å¤©ä»¥ä¸Š",icon:"ğŸ”¥",unlocked:!1,condition:t=>t.registeredDays>=7}]}),computed:{isLoggedIn:()=>t()},onLoad(){this.loadUserData()},onShow(){this.loadUserData()},onLoad(){e("learningComplete",(()=>{this.loadUserData()}))},onUnload(){s("learningComplete")},methods:{loadUserData(){this.currentUser=a(),this.userStats=l(),this.isLoggedIn&&(this.calculateTotalStats(),this.updateAchievements())},async calculateTotalStats(){try{let t=0,e=0,s=0;if(w&&w.length>0){const a=await S(),l=await U();t=a.length,e=l.length;const o=await D();o&&a.length>=o.wordCount&&(s=1)}this.totalLearnedWords=t,this.totalWrongWords=e,this.completedBooks=s}catch(t){console.error("è®¡ç®—ç»Ÿè®¡å¤±è´¥:",t),this.totalLearnedWords=0,this.totalWrongWords=0,this.completedBooks=0}},updateAchievements(){const t={totalLearnedWords:this.totalLearnedWords,registeredDays:this.userStats?this.userStats.registeredDays:0,completedBooks:this.completedBooks};this.achievements.forEach((e=>{e.unlocked=e.condition(t)}))},getBookProgressPercent(t){if(!this.isLoggedIn)return 0;try{const e=w.find((e=>e.id===t));if(!e)return 0;const s=getCurrentBookLearnedWords(),a=Math.round(s.length/e.wordCount*100);return Math.min(a,100)}catch(e){return 0}},formatDate(t){if(!t)return"æœªçŸ¥";try{return new Date(t).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"})}catch(e){return"æœªçŸ¥"}},goToLogin(){o({url:"/pages/login/login"})},goToRegister(){o({url:"/pages/register/register"})},confirmLogout(){n({title:"ç¡®è®¤é€€å‡º",content:"é€€å‡ºç™»å½•åï¼Œæ‚¨éœ€è¦é‡æ–°ç™»å½•æ‰èƒ½æŸ¥çœ‹å­¦ä¹ è¿›åº¦ã€‚ç¡®å®šè¦é€€å‡ºå—ï¼Ÿ",success:t=>{t.confirm&&this.handleLogout()}})},handleLogout(){const t=i();t.success?(c({title:t.message,icon:"success"}),this.currentUser=null,this.userStats=null,this.totalLearnedWords=0,this.totalWrongWords=0,this.completedBooks=0,setTimeout((()=>{d({url:"/pages/login/login"})}),1500)):c({title:t.message,icon:"none"})},showStudyStats(){const t=`å­¦ä¹ ç»Ÿè®¡ï¼š\n      \næ€»å­¦ä¹ è¯æ±‡ï¼š${this.totalLearnedWords} ä¸ª\næ€»é”™é¢˜æ•°ï¼š${this.totalWrongWords} ä¸ª\nå®Œæˆä¹¦ç±ï¼š${this.completedBooks} æœ¬\næ³¨å†Œå¤©æ•°ï¼š${this.userStats?this.userStats.registeredDays:0} å¤©\n\nç»§ç»­åŠªåŠ›å­¦ä¹ æ„å¤§åˆ©è¯­ï¼ğŸ‡®ğŸ‡¹`;n({title:"ğŸ“Š å­¦ä¹ ç»Ÿè®¡",content:t,showCancel:!1})},showAbout(){n({title:"â„¹ï¸ å…³äºåº”ç”¨",content:"è®°æ„ Parli v1.0\n\nä¸€æ¬¾ä¸“ä¸ºä¸­æ–‡ç”¨æˆ·è®¾è®¡çš„æ„å¤§åˆ©è¯­å­¦ä¹ åº”ç”¨\n\nğŸ“– è¯å…¸ï¼š45893ä¸ªè¯æ¡\nğŸ¯ åŠŸèƒ½ï¼šå­¦ä¹ ã€å¤ä¹ ã€æµ‹è¯•\nğŸŒŸ ç‰¹è‰²ï¼šå¤šç”¨æˆ·ã€è¿›åº¦ä¿å­˜ã€æˆå°±ç³»ç»Ÿ\n\nè®©æ„å¤§åˆ©è¯­å­¦ä¹ å˜å¾—ç®€å•æœ‰è¶£ï¼",showCancel:!1})}}},[["render",function(t,e,s,a,l,o){const n=g,i=y,c=W;return f(),r(n,{class:"container"},{default:u((()=>[_(n,{class:"user-section"},{default:u((()=>[_(n,{class:"avatar-container"},{default:u((()=>[_(n,{class:"avatar"},{default:u((()=>[h("ğŸ‘¤")])),_:1}),_(n,{class:"user-info"},{default:u((()=>[_(n,{class:"user-name"},{default:u((()=>[h(m(l.currentUser?l.currentUser.nickname:"æœªç™»å½•"),1)])),_:1}),_(n,{class:"user-subtitle"},{default:u((()=>[l.currentUser?(f(),r(i,{key:0},{default:u((()=>[h("@"+m(l.currentUser.username),1)])),_:1})):(f(),r(i,{key:1},{default:u((()=>[h("ç‚¹å‡»å³ä¸Šè§’ç™»å½•")])),_:1}))])),_:1})])),_:1}),_(n,{class:"login-status"},{default:u((()=>[o.isLoggedIn?(f(),r(c,{key:1,class:"logout-btn",onClick:o.handleLogout},{default:u((()=>[h(" é€€å‡º ")])),_:1},8,["onClick"])):(f(),r(c,{key:0,class:"login-btn",onClick:o.goToLogin},{default:u((()=>[h(" ç™»å½• ")])),_:1},8,["onClick"]))])),_:1})])),_:1}),l.currentUser?(f(),r(n,{key:0,class:"user-stats"},{default:u((()=>[_(n,{class:"stat-item"},{default:u((()=>[_(n,{class:"stat-number"},{default:u((()=>[h(m(l.totalLearnedWords),1)])),_:1}),_(n,{class:"stat-label"},{default:u((()=>[h("æ€»å­¦ä¹ è¯æ±‡")])),_:1})])),_:1}),_(n,{class:"stat-item"},{default:u((()=>[_(n,{class:"stat-number"},{default:u((()=>[h(m(l.userStats?l.userStats.registeredDays:0),1)])),_:1}),_(n,{class:"stat-label"},{default:u((()=>[h("æ³¨å†Œå¤©æ•°")])),_:1})])),_:1}),_(n,{class:"stat-item"},{default:u((()=>[_(n,{class:"stat-number"},{default:u((()=>[h(m(l.totalWrongWords),1)])),_:1}),_(n,{class:"stat-label"},{default:u((()=>[h("æ€»é”™é¢˜æ•°")])),_:1})])),_:1})])),_:1})):k("",!0)])),_:1}),o.isLoggedIn?(f(),r(n,{key:0,class:"achievements-section"},{default:u((()=>[_(n,{class:"section-title"},{default:u((()=>[_(i,null,{default:u((()=>[h("ğŸ† å­¦ä¹ æˆå°±")])),_:1})])),_:1}),_(n,{class:"achievements-grid"},{default:u((()=>[(f(!0),p(b,null,L(l.achievements,(t=>(f(),r(n,{key:t.id,class:v(["achievement-card",{unlocked:t.unlocked}])},{default:u((()=>[_(n,{class:"achievement-icon"},{default:u((()=>[h(m(t.icon),1)])),_:2},1024),_(n,{class:"achievement-info"},{default:u((()=>[_(n,{class:"achievement-title"},{default:u((()=>[h(m(t.title),1)])),_:2},1024),_(n,{class:"achievement-desc"},{default:u((()=>[h(m(t.description),1)])),_:2},1024)])),_:2},1024),t.unlocked?(f(),r(n,{key:0,class:"achievement-badge"},{default:u((()=>[h("âœ“")])),_:1})):k("",!0)])),_:2},1032,["class"])))),128))])),_:1})])),_:1})):k("",!0),o.isLoggedIn?(f(),r(n,{key:1,class:"books-progress-section"},{default:u((()=>[_(n,{class:"section-title"},{default:u((()=>[_(i,null,{default:u((()=>[h("ğŸ“š ä¹¦ç±è¿›åº¦")])),_:1})])),_:1}),_(n,{class:"books-progress-list"},{default:u((()=>[(f(!0),p(b,null,L(l.bookList,(t=>(f(),r(n,{key:t.id,class:"book-progress-item"},{default:u((()=>[_(n,{class:"book-icon"},{default:u((()=>[h(m(t.cover),1)])),_:2},1024),_(n,{class:"book-info"},{default:u((()=>[_(n,{class:"book-title"},{default:u((()=>[h(m(t.title),1)])),_:2},1024),_(n,{class:"progress-bar"},{default:u((()=>[_(n,{class:"progress-fill",style:C({width:o.getBookProgressPercent(t.id)+"%",backgroundColor:t.color})},null,8,["style"])])),_:2},1024),_(n,{class:"progress-text"},{default:u((()=>[h(m(o.getBookProgressPercent(t.id))+"%",1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})):k("",!0),o.isLoggedIn?(f(),r(n,{key:2,class:"user-details-section"},{default:u((()=>[_(n,{class:"section-title"},{default:u((()=>[_(i,null,{default:u((()=>[h("ğŸ‘¤ è´¦æˆ·ä¿¡æ¯")])),_:1})])),_:1}),_(n,{class:"details-list"},{default:u((()=>[_(n,{class:"detail-item"},{default:u((()=>[_(n,{class:"detail-label"},{default:u((()=>[h("ç”¨æˆ·å")])),_:1}),_(n,{class:"detail-value"},{default:u((()=>[h(m(l.currentUser.username),1)])),_:1})])),_:1}),_(n,{class:"detail-item"},{default:u((()=>[_(n,{class:"detail-label"},{default:u((()=>[h("æ˜µç§°")])),_:1}),_(n,{class:"detail-value"},{default:u((()=>[h(m(l.currentUser.nickname),1)])),_:1})])),_:1}),_(n,{class:"detail-item"},{default:u((()=>[_(n,{class:"detail-label"},{default:u((()=>[h("æ³¨å†Œæ—¶é—´")])),_:1}),_(n,{class:"detail-value"},{default:u((()=>[h(m(o.formatDate(l.currentUser.createdAt)),1)])),_:1})])),_:1}),_(n,{class:"detail-item"},{default:u((()=>[_(n,{class:"detail-label"},{default:u((()=>[h("æœ€åç™»å½•")])),_:1}),_(n,{class:"detail-value"},{default:u((()=>[h(m(o.formatDate(l.currentUser.lastLoginAt)),1)])),_:1})])),_:1})])),_:1})])),_:1})):k("",!0),_(n,{class:"settings-section"},{default:u((()=>[_(n,{class:"section-title"},{default:u((()=>[_(i,null,{default:u((()=>[h("âš™ï¸ è®¾ç½®")])),_:1})])),_:1}),_(n,{class:"settings-list"},{default:u((()=>[o.isLoggedIn?(f(),r(n,{key:0,class:"setting-item",onClick:o.showStudyStats},{default:u((()=>[_(n,{class:"setting-icon"},{default:u((()=>[h("ğŸ“Š")])),_:1}),_(n,{class:"setting-text"},{default:u((()=>[h("å­¦ä¹ ç»Ÿè®¡")])),_:1}),_(n,{class:"setting-arrow"},{default:u((()=>[h(">")])),_:1})])),_:1},8,["onClick"])):k("",!0),_(n,{class:"setting-item",onClick:o.showAbout},{default:u((()=>[_(n,{class:"setting-icon"},{default:u((()=>[h("â„¹ï¸")])),_:1}),_(n,{class:"setting-text"},{default:u((()=>[h("å…³äºåº”ç”¨")])),_:1}),_(n,{class:"setting-arrow"},{default:u((()=>[h(">")])),_:1})])),_:1},8,["onClick"]),o.isLoggedIn?(f(),r(n,{key:1,class:"setting-item danger",onClick:o.confirmLogout},{default:u((()=>[_(n,{class:"setting-icon"},{default:u((()=>[h("ğŸšª")])),_:1}),_(n,{class:"setting-text"},{default:u((()=>[h("é€€å‡ºç™»å½•")])),_:1}),_(n,{class:"setting-arrow"},{default:u((()=>[h(">")])),_:1})])),_:1},8,["onClick"])):k("",!0)])),_:1})])),_:1}),o.isLoggedIn?k("",!0):(f(),r(n,{key:3,class:"login-prompt"},{default:u((()=>[_(n,{class:"prompt-icon"},{default:u((()=>[h("ğŸ”")])),_:1}),_(n,{class:"prompt-title"},{default:u((()=>[h("ç™»å½•ä»¥ä¿å­˜å­¦ä¹ è¿›åº¦")])),_:1}),_(n,{class:"prompt-desc"},{default:u((()=>[h("ç™»å½•åæ‚¨çš„å­¦ä¹ è®°å½•å°†è‡ªåŠ¨äº‘ç«¯ä¿å­˜ï¼Œæ¢è®¾å¤‡ä¹Ÿä¸ä¼šä¸¢å¤±")])),_:1}),_(c,{class:"prompt-login-btn",onClick:o.goToLogin},{default:u((()=>[h("ç«‹å³ç™»å½•")])),_:1},8,["onClick"]),_(c,{class:"prompt-register-btn",onClick:o.goToRegister},{default:u((()=>[h("æ³¨å†Œæ–°è´¦å·")])),_:1},8,["onClick"])])),_:1}))])),_:1})}],["__scopeId","data-v-4b11bc0c"]]);export{I as default};
