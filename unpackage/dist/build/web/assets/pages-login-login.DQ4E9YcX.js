import{H as a,k as e,s,O as l,P as t,y as o,n as i,c as n,w as d,i as r,o as c,d as u,e as f,m,p,I as g,z as _}from"./index-B7OQiFPg.js";import{_ as h}from"./_plugin-vue_export-helper.BCo6x5W8.js";const w=h({data:()=>({formData:{username:"",password:""},loading:!1}),computed:{isFormValid(){return this.formData.username.length>=3&&this.formData.password.length>=6}},methods:{checkTempData:()=>a("learned_words_book_1",[]).length>0||a("wrong_words_book_1",[]).length>0,showMigrationPrompt:async()=>new Promise((a=>{e({title:"发现本地学习数据",content:"检测到您之前在未登录状态下学习了一些单词，是否要将这些学习记录导入到您的账户中？",confirmText:"导入数据",cancelText:"忽略",success:e=>{a(e.confirm)}})})),async handleLogin(){if(this.isFormValid){this.loading=!0;try{const e=await l(this.formData.username,this.formData.password);if(e.success){if(this.checkTempData()){if(await this.showMigrationPrompt())try{const a=await t();a.success?s({title:a.message,icon:"success"}):s({title:a.message,icon:"none"})}catch(a){console.error("数据迁移失败:",a),s({title:"数据导入失败，但登录成功",icon:"none"})}}else s({title:e.message,icon:"success"});setTimeout((()=>{o({url:"/pages/index/index"})}),2e3)}else s({title:e.message,icon:"none",duration:3e3})}catch(a){console.error("登录失败:",a),s({title:"登录失败，请重试",icon:"none"})}finally{this.loading=!1}}else s({title:"请检查输入信息",icon:"none"})},goToRegister(){i({url:"/pages/register/register"})}}},[["render",function(a,e,s,l,t,o){const i=r,h=p,w=g,k=_;return c(),n(i,{class:"login-container"},{default:d((()=>[u(i,{class:"header"},{default:d((()=>[u(i,{class:"app-logo"},{default:d((()=>[f("📖")])),_:1}),u(i,{class:"app-title"},{default:d((()=>[f("记意 Parli")])),_:1}),u(i,{class:"app-subtitle"},{default:d((()=>[f("意大利语背单词")])),_:1})])),_:1}),u(i,{class:"login-form"},{default:d((()=>[u(i,{class:"form-title"},{default:d((()=>[f("用户登录")])),_:1}),u(i,{class:"input-group"},{default:d((()=>[u(i,{class:"input-label"},{default:d((()=>[u(h,{class:"input-icon"},{default:d((()=>[f("👤")])),_:1}),u(h,null,{default:d((()=>[f("用户名")])),_:1})])),_:1}),u(w,{modelValue:t.formData.username,"onUpdate:modelValue":e[0]||(e[0]=a=>t.formData.username=a),class:"form-input",placeholder:"请输入用户名（至少3个字符）",disabled:t.loading,maxlength:"20"},null,8,["modelValue","disabled"])])),_:1}),u(i,{class:"input-group"},{default:d((()=>[u(i,{class:"input-label"},{default:d((()=>[u(h,{class:"input-icon"},{default:d((()=>[f("🔒")])),_:1}),u(h,null,{default:d((()=>[f("密码")])),_:1})])),_:1}),u(w,{modelValue:t.formData.password,"onUpdate:modelValue":e[1]||(e[1]=a=>t.formData.password=a),class:"form-input",placeholder:"请输入密码（至少6个字符）",password:"",disabled:t.loading,maxlength:"50"},null,8,["modelValue","disabled"])])),_:1}),u(i,{class:"form-actions"},{default:d((()=>[u(k,{class:m(["login-btn",{loading:t.loading}]),disabled:t.loading||!o.isFormValid,onClick:o.handleLogin},{default:d((()=>[t.loading?(c(),n(h,{key:0},{default:d((()=>[f("登录中...")])),_:1})):(c(),n(h,{key:1},{default:d((()=>[f("登录")])),_:1}))])),_:1},8,["class","disabled","onClick"]),u(i,{class:"form-links"},{default:d((()=>[u(h,{class:"link-text",onClick:o.goToRegister},{default:d((()=>[f("没有账号？立即注册")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1}),u(i,{class:"footer"},{default:d((()=>[u(h,{class:"footer-text"},{default:d((()=>[f("登录后您的学习进度将自动保存")])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-d25e2f80"]]);export{w as default};
