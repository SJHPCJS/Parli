import{$ as s,a as o,s as t,j as e,k as a,c as l,w as i,i as r,o as c,d as n,e as d,t as u,l as k,r as f,F as g,m as _,f as h,g as b,p}from"./index-B7OQiFPg.js";import{c as B,g as C,s as P,d as m,e as w,f as y}from"./bookData.ioIksG53.js";import{_ as x}from"./_plugin-vue_export-helper.BCo6x5W8.js";const W=x({data:()=>({bookList:B,currentBook:{},bookProgresses:{},bookWrongCounts:{}}),async onLoad(){this.currentBook=await C(),this.loadBookStatistics()},async onShow(){this.currentBook=await C(),this.loadBookStatistics()},onLoad(){s("learningComplete",(()=>{this.loadBookStatistics()}))},onUnload(){o("learningComplete")},methods:{selectBook(s){this.currentBook.id!==s.id&&(P(s.id),this.currentBook=s,t({title:`å·²åˆ‡æ¢åˆ°ã€Š${s.title}ã€‹`,icon:"success"}),setTimeout((()=>{e({url:"/pages/index/index"})}),1e3))},getBookProgressPercent(s){const o=this.bookProgresses[s];return o&&o.percentage||0},getBookWrongCount(s){return this.bookWrongCounts[s]||0},async loadBookStatistics(){try{for(const s of this.bookList){const o=await m(s.id);if(1===s.id){const o=await w();this.$set(this.bookWrongCounts,s.id,o.length)}else this.$set(this.bookWrongCounts,s.id,0);this.$set(this.bookProgresses,s.id,o)}}catch(s){console.error("åŠ è½½ä¹¦ç±ç»Ÿè®¡å¤±è´¥:",s)}},getBookWordsCount(s){const o=B.find((o=>o.id===s));return o?o.wordCount:0},showAllProgress(){let s="ğŸ“š æ€»ä½“å­¦ä¹ è¿›åº¦ï¼š\n\n";B.forEach((o=>{const t=this.getBookProgressPercent(o.id),e=this.getBookWrongCount(o.id);s+=`${o.title}\nè¿›åº¦ï¼š${t}% | é”™é¢˜ï¼š${e}ä¸ª\n\n`})),a({title:"å­¦ä¹ ç»Ÿè®¡",content:s,showCancel:!1})},resetAllProgress(){a({title:"é‡ç½®æ‰€æœ‰æ•°æ®",content:"ç¡®å®šè¦é‡ç½®æ‰€æœ‰ä¹¦ç±çš„å­¦ä¹ è¿›åº¦å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚",success:s=>{s.confirm&&(B.forEach((s=>{y(s.id,{learnedWords:[],wrongWords:[],reviewWords:[]})})),t({title:"é‡ç½®æˆåŠŸ",icon:"success"}))}})},exportProgress(){let s={exportTime:(new Date).toLocaleString(),books:{}};B.forEach((o=>{const t=m(o.id);s.books[o.id]={title:o.title,progress:t,progressPercent:this.getBookProgressPercent(o.id)}}));const o=JSON.stringify(s,null,2);a({title:"å¯¼å‡ºæ•°æ®",content:"å­¦ä¹ æ•°æ®å·²ç”Ÿæˆï¼Œè¯·å¤åˆ¶ä¿å­˜ã€‚",showCancel:!1,success:()=>{console.log("Export data:",o)}})}}},[["render",function(s,o,t,e,a,B){const C=r,P=p;return c(),l(C,{class:"container"},{default:i((()=>[n(C,{class:"header"},{default:i((()=>[n(C,{class:"title"},{default:i((()=>[d("é€‰æ‹©å­¦ä¹ ä¹¦ç±")])),_:1}),n(C,{class:"subtitle"},{default:i((()=>[d(u(a.bookList?a.bookList.length:0)+"æœ¬ä¹¦ç±å¯ä¾›é€‰æ‹©",1)])),_:1})])),_:1}),n(C,{class:"books-list"},{default:i((()=>[(c(!0),k(g,null,f(a.bookList,(s=>(c(),l(C,{key:s.id,class:_(["book-card",{active:a.currentBook.id===s.id}]),style:h({background:`linear-gradient(135deg, ${s.color}99, ${s.color}dd)`}),onClick:o=>B.selectBook(s)},{default:i((()=>[n(C,{class:"book-cover"},{default:i((()=>[d(u(s.cover),1)])),_:2},1024),n(C,{class:"book-info"},{default:i((()=>[n(C,{class:"book-title"},{default:i((()=>[d(u(s.title),1)])),_:2},1024),n(C,{class:"book-subtitle"},{default:i((()=>[d(u(s.subtitle),1)])),_:2},1024),n(C,{class:"book-desc"},{default:i((()=>[d(u(s.description),1)])),_:2},1024),n(C,{class:"book-meta"},{default:i((()=>[n(C,{class:"difficulty"},{default:i((()=>[d(u(s.difficulty),1)])),_:2},1024),n(C,{class:"word-count"},{default:i((()=>[d(u(s.wordCount)+"è¯",1)])),_:2},1024)])),_:2},1024)])),_:2},1024),n(C,{class:"book-progress"},{default:i((()=>[n(C,{class:"progress-info"},{default:i((()=>[n(P,null,{default:i((()=>[d("å­¦ä¹ è¿›åº¦ï¼š"+u(B.getBookProgressPercent(s.id))+"%",1)])),_:2},1024),n(P,null,{default:i((()=>[d("é”™é¢˜ï¼š"+u(B.getBookWrongCount(s.id)),1)])),_:2},1024)])),_:2},1024),n(C,{class:"progress-bar"},{default:i((()=>[n(C,{class:"progress-fill",style:h({width:B.getBookProgressPercent(s.id)+"%"})},null,8,["style"])])),_:2},1024)])),_:2},1024),a.currentBook.id===s.id?(c(),l(C,{key:0,class:"selected-mark"},{default:i((()=>[n(P,null,{default:i((()=>[d("âœ“")])),_:1})])),_:1})):b("",!0)])),_:2},1032,["class","style","onClick"])))),128))])),_:1}),n(C,{class:"quick-actions"},{default:i((()=>[n(C,{class:"section-title"},{default:i((()=>[d("å¿«é€Ÿæ“ä½œ")])),_:1}),n(C,{class:"actions-grid"},{default:i((()=>[n(C,{class:"action-item",onClick:B.showAllProgress},{default:i((()=>[n(C,{class:"action-icon"},{default:i((()=>[d("ğŸ“Š")])),_:1}),n(C,{class:"action-text"},{default:i((()=>[d("æ€»ä½“è¿›åº¦")])),_:1})])),_:1},8,["onClick"]),n(C,{class:"action-item",onClick:B.resetAllProgress},{default:i((()=>[n(C,{class:"action-icon"},{default:i((()=>[d("ğŸ”„")])),_:1}),n(C,{class:"action-text"},{default:i((()=>[d("é‡ç½®æ‰€æœ‰")])),_:1})])),_:1},8,["onClick"]),n(C,{class:"action-item",onClick:B.exportProgress},{default:i((()=>[n(C,{class:"action-icon"},{default:i((()=>[d("ğŸ“¤")])),_:1}),n(C,{class:"action-text"},{default:i((()=>[d("å¯¼å‡ºæ•°æ®")])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-897856ad"]]);export{W as default};
