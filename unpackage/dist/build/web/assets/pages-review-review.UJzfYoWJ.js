import{A as s,C as t,c as e,w as l,i as a,o as i,d as o,e as n,f as r,t as u,l as d,r as c,F as p,m as h,g as f,z as g,p as _,I as w}from"./index-B7OQiFPg.js";import{p as m,g as R,e as k,h as W,r as C,k as y}from"./bookData.ioIksG53.js";import{_ as b}from"./_plugin-vue_export-helper.BCo6x5W8.js";const x=b({data:()=>({step:1,current:{},options:[],selectedOption:-1,showResult:!1,step1Result:!1,userInput:"",showSpellingResult:!1,spellingResult:!1,showWordDetail:!1,currentIndex:0,totalQuestions:0,masteredWords:0,remainingWords:0,isCompleted:!1,wrongWords:[],hasWrongWords:!1,posMap:m,currentBook:{}}),computed:{progressWidth(){return this.totalQuestions>0?this.currentIndex/this.totalQuestions*100:0}},onLoad(){this.currentBook=R(),this.initReview()},onShow(){this.initReview()},methods:{async initReview(){try{this.wrongWords=await k(),this.hasWrongWords=this.wrongWords.length>0,this.hasWrongWords&&(this.totalQuestions=this.wrongWords.length,this.currentIndex=0,this.masteredWords=0,this.remainingWords=0,this.isCompleted=!1,await this.loadQuestion())}catch(s){console.error("åˆå§‹åŒ–å¤ä¹ å¤±è´¥:",s),this.hasWrongWords=!1,this.wrongWords=[]}},async loadQuestion(){this.currentIndex>=this.totalQuestions?this.isCompleted=!0:(this.current=this.wrongWords[this.currentIndex],await this.generateOptions(),this.resetState())},async generateOptions(){try{const s=(await W()).filter((s=>s.id!==this.current.id)).sort((()=>.5-Math.random())).slice(0,2);this.options=[this.current,...s].sort((()=>.5-Math.random()))}catch(s){console.error("ç”Ÿæˆé€‰é¡¹å¤±è´¥:",s),this.options=[this.current]}},resetState(){this.step=1,this.selectedOption=-1,this.showResult=!1,this.step1Result=!1,this.userInput="",this.showSpellingResult=!1,this.spellingResult=!1,this.showWordDetail=!1},selectOption(s,t){this.showResult||(this.selectedOption=s,this.step1Result=t.id===this.current.id,this.showResult=!0,this.step1Result||setTimeout((()=>{this.showResult=!1,this.selectedOption=-1}),2e3))},goToStep2(){this.step=2,this.showResult=!1},checkSpelling(){this.userInput.trim()&&(this.spellingResult=this.userInput.trim().toLowerCase()===this.current.word.toLowerCase(),this.showSpellingResult=!0,this.spellingResult&&this.step1Result?(C(this.current.id),y(this.current.id),this.masteredWords++,setTimeout((()=>{this.showWordDetail=!0}),1500)):this.remainingWords++)},clearSpellingResult(){this.showSpellingResult=!1},async nextQuestion(){this.currentIndex++,await this.loadQuestion()},restartReview(){this.initReview()},goHome(){s()},goToLearn(){t({url:"/pages/learn/learn"})}}},[["render",function(s,t,m,R,k,W){const C=a,y=g,b=_,x=w;return i(),e(C,{class:"container"},{default:l((()=>[k.hasWrongWords?(i(),e(C,{key:1},{default:l((()=>[o(C,{class:"progress-bar"},{default:l((()=>[o(C,{class:"progress-fill",style:r({width:W.progressWidth+"%"})},null,8,["style"])])),_:1}),o(C,{class:"progress-text"},{default:l((()=>[n("å¤ä¹ è¿›åº¦ï¼š"+u(k.currentIndex+1)+" / "+u(k.totalQuestions),1)])),_:1}),1===k.step?(i(),e(C,{key:0,class:"step-container"},{default:l((()=>[o(C,{class:"title"},{default:l((()=>[n("å¤ä¹ ï¼šé€‰æ‹©è¯¥å•è¯çš„è¯æ€§å’Œæ„æ€")])),_:1}),o(C,{class:"word-display"},{default:l((()=>[n(u(k.current.word),1)])),_:1}),o(C,{class:"options-container"},{default:l((()=>[(i(!0),d(p,null,c(k.options,((s,t)=>(i(),e(C,{key:t,class:h(["option",{selected:k.selectedOption===t,correct:k.showResult&&s.id===k.current.id,wrong:k.showResult&&k.selectedOption===t&&s.id!==k.current.id}]),onClick:e=>W.selectOption(t,s)},{default:l((()=>[o(C,{class:"option-text"},{default:l((()=>[o(b,{class:"pos-tag"},{default:l((()=>[n(u(k.posMap[s.pos]),1)])),_:2},1024),o(b,{class:"meaning"},{default:l((()=>[n(u(s.meaning),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1}),k.showResult?(i(),e(C,{key:0,class:"result-container"},{default:l((()=>[o(C,{class:h(["result-text",{correct:k.step1Result,wrong:!k.step1Result}])},{default:l((()=>[n(u(k.step1Result?"æ­£ç¡®ï¼ç»§ç»­ä¸‹ä¸€æ­¥":"é”™è¯¯ï¼è¯·é‡æ–°é€‰æ‹©"),1)])),_:1},8,["class"]),k.step1Result?(i(),e(y,{key:0,class:"next-btn",onClick:W.goToStep2},{default:l((()=>[n("ä¸‹ä¸€æ­¥ï¼šæ‹¼å†™ç»ƒä¹ ")])),_:1},8,["onClick"])):f("",!0)])),_:1})):f("",!0)])),_:1})):f("",!0),2===k.step?(i(),e(C,{key:1,class:"step-container"},{default:l((()=>[o(C,{class:"title"},{default:l((()=>[n("å¤ä¹ ï¼šè¯·æ‹¼å†™è¿™ä¸ªå•è¯")])),_:1}),o(C,{class:"clue-container"},{default:l((()=>[o(C,{class:"clue"},{default:l((()=>[o(b,{class:"pos-tag"},{default:l((()=>[n(u(k.posMap[k.current.pos]),1)])),_:1}),o(b,{class:"meaning"},{default:l((()=>[n(u(k.current.meaning),1)])),_:1})])),_:1})])),_:1}),o(C,{class:"input-container"},{default:l((()=>[o(x,{modelValue:k.userInput,"onUpdate:modelValue":t[0]||(t[0]=s=>k.userInput=s),placeholder:"è¯·è¾“å…¥æ„å¤§åˆ©è¯­å•è¯",class:h(["input",{correct:k.showSpellingResult&&k.spellingResult,wrong:k.showSpellingResult&&!k.spellingResult}]),onInput:W.clearSpellingResult},null,8,["modelValue","class","onInput"]),o(y,{class:"submit-btn",onClick:W.checkSpelling,disabled:!k.userInput.trim()},{default:l((()=>[n("æäº¤")])),_:1},8,["onClick","disabled"])])),_:1}),k.showSpellingResult?(i(),e(C,{key:0,class:"result-container"},{default:l((()=>[o(C,{class:h(["result-text",{correct:k.spellingResult,wrong:!k.spellingResult}])},{default:l((()=>[n(u(k.spellingResult?"æ‹¼å†™æ­£ç¡®ï¼":`é”™è¯¯ï¼æ­£ç¡®ç­”æ¡ˆæ˜¯ï¼š${k.current.word}`),1)])),_:1},8,["class"]),k.spellingResult?f("",!0):(i(),e(y,{key:0,class:"next-btn",onClick:W.nextQuestion},{default:l((()=>[n("ä¸‹ä¸€é¢˜")])),_:1},8,["onClick"]))])),_:1})):f("",!0)])),_:1})):f("",!0),k.showWordDetail?(i(),e(C,{key:2,class:"word-detail-container"},{default:l((()=>[o(C,{class:"detail-header"},{default:l((()=>[o(C,{class:"detail-title"},{default:l((()=>[n("å•è¯è¯¦æƒ…")])),_:1})])),_:1}),o(C,{class:"detail-content"},{default:l((()=>[o(C,{class:"word-display-large"},{default:l((()=>[n(u(k.current.word),1)])),_:1}),o(C,{class:"detail-item"},{default:l((()=>[o(C,{class:"detail-label"},{default:l((()=>[n("è¯æ€§")])),_:1}),o(C,{class:"detail-value pos-tag"},{default:l((()=>[n(u(k.posMap[k.current.pos]),1)])),_:1})])),_:1}),o(C,{class:"detail-item"},{default:l((()=>[o(C,{class:"detail-label"},{default:l((()=>[n("ä¸­æ–‡æ„æ€")])),_:1}),o(C,{class:"detail-value meaning-text"},{default:l((()=>[n(u(k.current.meaning),1)])),_:1})])),_:1}),o(C,{class:"detail-item"},{default:l((()=>[o(C,{class:"detail-label"},{default:l((()=>[n("å­¦ä¹ çŠ¶æ€")])),_:1}),o(C,{class:"detail-value"},{default:l((()=>[o(C,{class:"status-badge mastered"},{default:l((()=>[n("âœ“ å·²æŽŒæ¡")])),_:1})])),_:1})])),_:1})])),_:1}),o(C,{class:"detail-actions"},{default:l((()=>[o(y,{class:"continue-btn",onClick:W.nextQuestion},{default:l((()=>[n("ä¸‹ä¸€é¢˜")])),_:1},8,["onClick"])])),_:1})])),_:1})):f("",!0),k.isCompleted?(i(),e(C,{key:3,class:"completion-container"},{default:l((()=>[o(C,{class:"completion-icon"},{default:l((()=>[n("ðŸŽ‰")])),_:1}),o(C,{class:"completion-title"},{default:l((()=>[n("å¤ä¹ å®Œæˆï¼")])),_:1}),o(C,{class:"completion-stats"},{default:l((()=>[o(C,{class:"stat-item"},{default:l((()=>[o(b,{class:"stat-label"},{default:l((()=>[n("å¤ä¹ é¢˜æ•°ï¼š")])),_:1}),o(b,{class:"stat-value"},{default:l((()=>[n(u(k.totalQuestions),1)])),_:1})])),_:1}),o(C,{class:"stat-item"},{default:l((()=>[o(b,{class:"stat-label"},{default:l((()=>[n("æŽŒæ¡é¢˜æ•°ï¼š")])),_:1}),o(b,{class:"stat-value"},{default:l((()=>[n(u(k.masteredWords),1)])),_:1})])),_:1}),o(C,{class:"stat-item"},{default:l((()=>[o(b,{class:"stat-label"},{default:l((()=>[n("ä»éœ€å¤ä¹ ï¼š")])),_:1}),o(b,{class:"stat-value"},{default:l((()=>[n(u(k.remainingWords),1)])),_:1})])),_:1})])),_:1}),o(y,{class:"restart-btn",onClick:W.restartReview},{default:l((()=>[n("å†æ¬¡å¤ä¹ ")])),_:1},8,["onClick"]),o(y,{class:"home-btn",onClick:W.goHome},{default:l((()=>[n("å›žåˆ°é¦–é¡µ")])),_:1},8,["onClick"])])),_:1})):f("",!0)])),_:1})):(i(),e(C,{key:0,class:"no-words-container"},{default:l((()=>[o(C,{class:"no-words-icon"},{default:l((()=>[n("ðŸ“š")])),_:1}),o(C,{class:"no-words-title"},{default:l((()=>[n("æš‚æ— é”™é¢˜éœ€è¦å¤ä¹ ")])),_:1}),o(C,{class:"no-words-desc"},{default:l((()=>[n("ç»§ç»­å­¦ä¹ ç§¯ç´¯æ›´å¤šè¯æ±‡å§ï¼")])),_:1}),o(y,{class:"go-learn-btn",onClick:W.goToLearn},{default:l((()=>[n("å¼€å§‹å­¦ä¹ ")])),_:1},8,["onClick"])])),_:1}))])),_:1})}],["__scopeId","data-v-f9923ba7"]]);export{x as default};
