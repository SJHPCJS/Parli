import{D as s,E as e,k as a,G as t,s as r,n as o,c as l,w as c,i as d,o as i,d as h,e as n,g as u,t as m,l as f,r as y,F as _,I as p,p as k,z as g,m as w}from"./index-B7OQiFPg.js";import{p as S,o as C,q as H}from"./bookData.ioIksG53.js";import{_ as W}from"./_plugin-vue_export-helper.BCo6x5W8.js";const R=W({data:()=>({searchQuery:"",searchResults:[],hasSearched:!1,searchHistory:[],recommendWords:[],allWords:[],learnedWords:[],posMap:S}),onLoad(){this.loadData(),this.loadSearchHistory(),this.loadRecommendWords()},methods:{loadData(){this.allWords=[],this.learnedWords=C()},loadSearchHistory(){try{const e=s("search_history")||[];this.searchHistory=e.slice(0,10)}catch(e){this.searchHistory=[]}},loadRecommendWords(){const s=["a","e","i","o","u","c","l","m","n","r","s","t"],e=s[Math.floor(Math.random()*s.length)],a=[...H(e)].sort((()=>.5-Math.random()));this.recommendWords=a.slice(0,20)},onSearchInput(){this.searchQuery.trim()?this.performSearch():(this.searchResults=[],this.hasSearched=!1)},performSearch(){const s=this.searchQuery.trim();if(!s)return this.searchResults=[],void(this.hasSearched=!1);this.hasSearched=!0;const e=H(s);this.searchResults=e.sort(((e,a)=>{const t=e.word.toLowerCase()===s.toLowerCase(),r=a.word.toLowerCase()===s.toLowerCase(),o=e.meaning===s,l=a.meaning===s;return t&&!r?-1:!t&&r?1:o&&!l?-1:!o&&l?1:0})),this.saveSearchHistory(s)},saveSearchHistory(a){try{let t=s("search_history")||[];t=t.filter((s=>s!==a)),t.unshift(a),t=t.slice(0,50),e("search_history",t),this.searchHistory=t.slice(0,10)}catch(t){console.error("保存搜索历史失败:",t)}},searchFromHistory(s){this.searchQuery=s,this.performSearch()},clearHistory(){a({title:"确认",content:"确定要清空搜索历史吗？",success:s=>{if(s.confirm)try{t("search_history"),this.searchHistory=[],r({title:"已清空历史记录",icon:"success"})}catch(e){console.error("清空历史记录失败:",e)}}})},isWordLearned(s){return this.learnedWords.some((e=>e.id===s))},goToWordDetail(s){o({url:`/pages/wordDetail/wordDetail?wordId=${s.id}&fromPage=search&queryMode=true`})}}},[["render",function(s,e,a,t,r,o){const S=p,C=k,H=g,W=d;return i(),l(W,{class:"container"},{default:c((()=>[h(W,{class:"search-section"},{default:c((()=>[h(W,{class:"search-bar"},{default:c((()=>[h(W,{class:"search-input-container"},{default:c((()=>[h(S,{modelValue:r.searchQuery,"onUpdate:modelValue":e[0]||(e[0]=s=>r.searchQuery=s),placeholder:"输入中文或意大利语单词...",class:"search-input",onInput:o.onSearchInput,"confirm-type":"search",onConfirm:o.performSearch},null,8,["modelValue","onInput","onConfirm"]),h(H,{class:"search-btn",onClick:o.performSearch},{default:c((()=>[h(C,{class:"search-icon"},{default:c((()=>[n("🔍")])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1}),r.searchQuery?u("",!0):(i(),l(W,{key:0,class:"search-tips"},{default:c((()=>[h(C,{class:"tip-text"},{default:c((()=>[n("💡 支持中文和意大利语搜索")])),_:1})])),_:1}))])),_:1}),r.searchResults.length>0?(i(),l(W,{key:0,class:"results-section"},{default:c((()=>[h(W,{class:"results-header"},{default:c((()=>[h(C,{class:"results-title"},{default:c((()=>[n("搜索结果")])),_:1}),h(C,{class:"results-count"},{default:c((()=>[n("共"+m(r.searchResults.length)+"条",1)])),_:1})])),_:1}),h(W,{class:"results-list"},{default:c((()=>[(i(!0),f(_,null,y(r.searchResults,(s=>(i(),l(W,{key:s.id,class:"word-item",onClick:e=>o.goToWordDetail(s)},{default:c((()=>[h(W,{class:"word-main"},{default:c((()=>[h(W,{class:"word-text"},{default:c((()=>[n(m(s.word),1)])),_:2},1024),h(W,{class:"word-pos"},{default:c((()=>[n(m(r.posMap[s.pos]),1)])),_:2},1024)])),_:2},1024),h(W,{class:"word-meaning"},{default:c((()=>[n(m(s.meaning),1)])),_:2},1024),h(W,{class:"word-status"},{default:c((()=>[h(W,{class:w(["status-dot",{active:o.isWordLearned(s.id)}])},null,8,["class"]),h(C,{class:"status-text"},{default:c((()=>[n(m(o.isWordLearned(s.id)?"已学":"未学"),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})):u("",!0),r.hasSearched&&0===r.searchResults.length?(i(),l(W,{key:1,class:"no-results"},{default:c((()=>[h(W,{class:"no-results-icon"},{default:c((()=>[n("🔍")])),_:1}),h(W,{class:"no-results-title"},{default:c((()=>[n("未找到相关单词")])),_:1}),h(W,{class:"no-results-desc"},{default:c((()=>[n("请尝试其他搜索词汇")])),_:1})])),_:1})):u("",!0),!r.hasSearched&&r.searchHistory.length>0?(i(),l(W,{key:2,class:"history-section"},{default:c((()=>[h(W,{class:"history-header"},{default:c((()=>[h(C,{class:"history-title"},{default:c((()=>[n("搜索历史")])),_:1}),h(H,{class:"clear-history-btn",onClick:o.clearHistory},{default:c((()=>[n("清空")])),_:1},8,["onClick"])])),_:1}),h(W,{class:"history-list"},{default:c((()=>[(i(!0),f(_,null,y(r.searchHistory,((s,e)=>(i(),l(W,{key:e,class:"history-item",onClick:e=>o.searchFromHistory(s)},{default:c((()=>[h(C,{class:"history-text"},{default:c((()=>[n(m(s),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})):u("",!0),r.hasSearched||0!==r.searchHistory.length?u("",!0):(i(),l(W,{key:3,class:"recommend-section"},{default:c((()=>[h(W,{class:"recommend-header"},{default:c((()=>[h(C,{class:"recommend-title"},{default:c((()=>[n("推荐词汇")])),_:1})])),_:1}),h(W,{class:"recommend-list"},{default:c((()=>[(i(!0),f(_,null,y(r.recommendWords,(s=>(i(),l(W,{key:s.id,class:"recommend-item",onClick:e=>o.goToWordDetail(s)},{default:c((()=>[h(W,{class:"recommend-word"},{default:c((()=>[n(m(s.word),1)])),_:2},1024),h(W,{class:"recommend-meaning"},{default:c((()=>[n(m(s.meaning),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1}))])),_:1})}],["__scopeId","data-v-30db805f"]]);export{R as default};
